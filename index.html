<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Харе Кришна</title>

  <!-- рукописные шрифты -->
  <link
    href="https://fonts.googleapis.com/css2?family=Bad+Script&family=Great+Vibes&display=swap"
    rel="stylesheet">
  <!-- тема по умолчанию — тёмная -->
  <link id="themeStylesheet" rel="stylesheet" href="style.css">
</head>
<body>

  <!-- счётчик кругов / бусин -->
  <div class="counter" id="counter">Круги: 0 | Бусины: 0</div>

   <!-- Панель управления -->
  <div class="controls">
    <button id="decSpeed" class="spd-btn" aria-label="Снизить скорость">−</button>
    <span id="speedDisplay" class="spd-text">5 с</span>
    <button id="incSpeed" class="spd-btn" aria-label="Увеличить скорость">+</button>
    
    <!-- Кнопка-темы -->
    <button id="themeToggle" class="icon-btn" aria-label="Смена темы">
      <!-- ЛУНА (по умолчанию скрыта) -->
      <svg id="moonIcon" class="hidden" viewBox="0 0 24 24" width="24" height="24"
           fill="none" stroke="currentColor" stroke-width="2"
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3
                 a7 7 0 0 0 9.79 9.79z"/>
      </svg>
      <!-- СОЛНЦЕ (видно по умолчанию) -->
      <svg id="sunIcon" viewBox="0 0 24 24" width="24" height="24"
           fill="none" stroke="currentColor" stroke-width="2"
           stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="5"/>
        <line x1="12" y1="1"  x2="12" y2="3"/>
        <line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22"  y1="4.22"  x2="5.64"  y2="5.64"/>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1"     y1="12"    x2="3"     y2="12"/>
        <line x1="21"    y1="12"    x2="23"    y2="12"/>
        <line x1="4.22"  y1="19.78" x2="5.64"  y2="18.36"/>
        <line x1="18.36" y1="5.64"  x2="19.78" y2="4.22"/>
      </svg>
    </button>
  </div>

  <!-- Текст мантры -->
  <div class="centered">
    <div class="waviy" id="mainLine">
      <span style="--i:1">Харе</span>
      <span style="--i:2">Кришна</span>
      <span style="--i:3">Харе</span>
      <span style="--i:4">Кришна</span><br>
      <span style="--i:5">Кришна</span>
      <span style="--i:6">Кришна</span>
      <span style="--i:7">Харе</span>
      <span style="--i:8">Харе</span><br>
      <span style="--i:9">Харе</span>
      <span style="--i:10">Рама</span>
      <span style="--i:11">Харе</span>
      <span style="--i:12">Рама</span><br>
      <span style="--i:13">Рама</span>
      <span style="--i:14">Рама</span>
      <span style="--i:15">Харе</span>
      <span style="--i:16">Харе</span>
    </div>
  </div>

 <script>
    /* DOM */
    const decBtn      = document.getElementById('decSpeed');
    const incBtn      = document.getElementById('incSpeed');
    const speedTxt    = document.getElementById('speedDisplay');
    const themeBtn    = document.getElementById('themeToggle');
    const themeLink   = document.getElementById('themeStylesheet');
    const moonIcon    = document.getElementById('moonIcon');
    const sunIcon     = document.getElementById('sunIcon');
    const counterEl   = document.getElementById('counter');

    /* счётчики круг / бусина */
    let beads  = 0;
    let rounds = 0;

        /* скорость */
    let speed = 5.0;             // сек. по умолчанию
    const min = 3.0, max = 10.0, step = 0.5;

    function applySpeed(){
      const dur  = speed + 's';
      const part = (speed / 16).toFixed(3) + 's';
      document.documentElement.style.setProperty('--speed', dur);
      document.documentElement.style.setProperty('--step',  part);
      speedTxt.textContent = speed.toFixed(1) + ' с';
    }
    applySpeed();

   decBtn.addEventListener('click', ()=>{          // −
  if (speed > min) { speed -= step; applySpeed(); }
});
incBtn.addEventListener('click', ()=>{          // +
  if (speed < max) { speed += step; applySpeed(); }
});

    /* переключение темы + иконок */
    function switchTheme(){
      const dark = themeLink.href.endsWith('style.css');   /* сейчас тёмная? */
      themeLink.href = dark ? 'style2.css' : 'style.css';
      moonIcon.classList.toggle('hidden', !dark);  // показать => скрыть
      sunIcon.classList.toggle('hidden',  dark);   // скрыть   => показать
    }
    themeToggle.addEventListener('click', switchTheme);

    /* счётчик бусин / кругов */
    document.querySelector('.waviy span[style*="--i:16"]')
      .addEventListener('animationiteration',()=>{
        if(++beads >= 108){ beads = 0; ++rounds; }
        counterEl.textContent = `Круги: ${rounds} | Бусины: ${beads}`;
      });

  </script>
</body>
</html>
