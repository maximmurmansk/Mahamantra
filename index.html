<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <title>Ğ¥Ğ°Ñ€Ğµ ĞšÑ€Ğ¸ÑˆĞ½Ğ°</title>

        <!-- ÑˆÑ€Ğ¸Ñ„Ñ‚Ñ‹ -->
        <link
            href="https://fonts.googleapis.com/css2?family=Bad+Script&family=Great+Vibes&display=swap"
            rel="stylesheet"
        />

        <!-- Ñ‚ĞµĞ¼Ğ° Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ â€” ÑĞ²ĞµÑ‚Ğ»Ğ°Ñ -->
        <link id="themeStylesheet" rel="stylesheet" href="style2.css" />
    </head>
    <body>
        <!-- ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº -->
        <div class="counter" id="counter">ĞšÑ€ÑƒĞ³Ğ¸: 1 | Ğ‘ÑƒÑĞ¸Ğ½Ñ‹: 1</div>

        <!-- ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ ÑĞ·Ñ‹ĞºĞ° -->
        <select
            id="langSel"
            class="icon-btn"
            style="position: fixed; left: 10px; top: 10px; z-index: 20"
        >
            <option value="ru">ğŸ‡·ğŸ‡ºâ€ƒRu</option>
            <option value="en">ğŸ‡¬ğŸ‡§â€ƒEn</option>
            <option value="pl">ğŸ‡µğŸ‡±â€ƒPl</option>
            <option value="de">ğŸ‡©ğŸ‡ªâ€ƒDe</option>
            <option value="uk">ğŸ‡ºğŸ‡¦â€ƒUk</option>
            <option value="cs">ğŸ‡¨ğŸ‡¿â€ƒCs</option>
            <option value="be">ğŸ‡§ğŸ‡¾â€ƒBe</option>
            <option value="tr">ğŸ‡¹ğŸ‡·â€ƒTr</option>
            <option value="el">ğŸ‡¬ğŸ‡·â€ƒEl</option>
            <option value="ka">ğŸ‡¬ğŸ‡ªâ€ƒKa</option>
            <option value="he">ğŸ‡®ğŸ‡±â€ƒHe</option>
            <option value="yi">ğŸ•â€ƒYi</option>
            <option value="ja">ğŸ‡¯ğŸ‡µâ€ƒJa</option>
            <option value="ko">ğŸ‡°ğŸ‡·â€ƒKo</option>
        </select>

        <!-- Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ -->
        <div id="intro" class="intro">
            <span>(Ğ´Ğ¶Ğ°Ğ¹Ğ°) Ğ¨Ñ€Ğ¸-ĞšÑ€Ğ¸ÑˆĞ½Ğ°-Ğ§Ğ°Ğ¹Ñ‚Ğ°Ğ½Ğ¸Ñ</span>
            <span>ĞŸÑ€Ğ°Ğ±Ñ…Ñƒ ĞĞ¸Ñ‚ÑŒÑĞ½Ğ°Ğ½Ğ´Ğ°</span>
            <span>Ğ¨Ñ€Ğ¸-ĞĞ´Ğ²Ğ°Ğ¹Ñ‚Ğ° Ğ“Ğ°Ğ´Ğ°Ğ´Ñ…Ğ°Ñ€Ğ°</span>
            <span>Ğ¨Ñ€Ğ¸Ğ²Ğ°ÑĞ°Ğ´Ğ¸-Ğ“Ğ°ÑƒÑ€Ğ°-Ğ‘Ñ…Ğ°ĞºÑ‚Ğ°-Ğ’Ñ€Ğ¸Ğ½Ğ´Ğ°</span>
        </div>

        <!-- Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Â± ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ° -->
        <div class="font-ctrl" id="fontCtrl">
            <button id="fInc" class="f-btn">+</button>
            <button id="fDec" class="f-btn">âˆ’</button>
        </div>

        <!-- Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸ / Ñ‚ĞµĞ¼Ñ‹ -->
        <div class="controls">
            <button id="dec" class="spd-btn">âˆ’</button>
            <span id="spdText" class="spd-text">5Ñ</span>
            <button id="inc" class="spd-btn">+</button>

            <!-- Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ Ñ‚ĞµĞ¼Ñ‹ -->
            <button id="theme" class="icon-btn" aria-label="Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ¼Ñƒ">
                <svg
                    id="moon"
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
                <svg
                    id="sun"
                    class="hidden"
                    viewBox="0 0 24 24"
                    width="24"
                    height="24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <circle cx="12" cy="12" r="5" />
                    <line x1="12" y1="1" x2="12" y2="3" />
                    <line x1="12" y1="21" x2="12" y2="23" />
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                    <line x1="1" y1="12" x2="3" y2="12" />
                    <line x1="21" y1="12" x2="23" y2="12" />
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                </svg>
            </button>
        </div>

        <!-- Ñ‚ĞµĞºÑÑ‚ Ğ¼Ğ°Ğ½Ñ‚Ñ€Ñ‹ (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ½Ğ´ĞµÑ€ Ğ¸Ğ· json) -->
        <div class="centered">
            <div class="waviy" id="waviy"></div>
        </div>

        <!-- === ĞĞ¡ĞĞĞ’ĞĞĞ™ JS (ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº, ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ, Ñ‚ĞµĞ¼Ğ°, ÑˆÑ€Ğ¸Ñ„Ñ‚) === -->
        <script>
            /* Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ */
            let beads = 1,
                rounds = 1,
                introVisible = true;
            const waviy = document.getElementById("waviy");
            const out = document.getElementById("counter");
            const intro = document.getElementById("intro");

            function updateCounter() {
                out.textContent = `ĞšÑ€ÑƒĞ³Ğ¸: ${rounds} | Ğ‘ÑƒÑĞ¸Ğ½Ñ‹: ${beads}`;
            }

            /* Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ†Ğ¸ĞºĞ»Ğ° */
            function onIter() {
                if (introVisible) return;
                if (++beads > 108) {
                    beads = 0;
                    ++rounds;
                    showIntro();
                }
                updateCounter();
            }

            /* Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµĞ¼ id="first" Ğ¸ ÑĞ»ÑƒÑˆĞ°Ñ‚ĞµĞ»ÑŒ */
            function attachFirstListener() {
                waviy
                    .querySelectorAll("#first")
                    .forEach((el) => el.removeAttribute("id"));
                const firstSpan = waviy.querySelector("span");
                if (!firstSpan) return;
                firstSpan.id = "first";
                firstSpan.addEventListener("animationiteration", onIter);
            }

            /* ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ğ¸ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ â€” Ğ¾ÑÑ‚Ğ°Ğ»Ğ¸ÑÑŒ Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ ... */

            function showIntro() {
                /* Ğ²Ğ°ÑˆĞ° Ñ‚ĞµĞºÑƒÑ‰Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° */
            }

            attachFirstListener(); // ÑĞ»ÑƒÑˆĞ°Ñ‚ĞµĞ»ÑŒ Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ğ²Ğ¾Ğ»Ğ½Ñ‹
        </script>

        <!-- ===== JSON-Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´ + Ñ€ĞµĞ½Ğ´ĞµÑ€ ===== -->
        <script type="module">
            (async () => {
                const translations = await fetch("translations.json").then(
                    (r) => r.json(),
                );
                const langSel = document.getElementById("langSel");

                function render(lang = "ru") {
                    const text = translations[lang] || translations.ru;
                    const words = text.split(/\s+/).filter(Boolean);
                    const html = words
                        .map(
                            (w, i) =>
                                `<span style="--i:${(i % 16) + 1}">${w}</span>${i % 4 === 3 && i !== 15 ? "<br>" : ""}`,
                        )
                        .join("");
                    waviy.innerHTML = html;
                    attachFirstListener();
                }

                render("ru");
                langSel.addEventListener("change", (e) =>
                    render(e.target.value),
                );
            })();
        </script>
    </body>
</html>
